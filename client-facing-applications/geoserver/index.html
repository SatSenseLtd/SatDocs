
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.5.2">
    
    
      
        <title>Overview - SatDocs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.9f9400aa.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
          
          
          <meta name="theme-color" content="#ef5552">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="red" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#overview" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="SatDocs" class="md-header__button md-logo" aria-label="SatDocs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SatDocs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Overview
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="SatDocs" class="md-nav__button md-logo" aria-label="SatDocs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    SatDocs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        SatSense Documentation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../AWS/" class="md-nav__link">
        Setting up AWS for processing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../daemon/" class="md-nav__link">
        SatDaemon (SQLAlchemy Version)
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../dataprocessing/" class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../jira/" class="md-nav__link">
        Jira
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../sftp_user_setup/" class="md-nav__link">
        Sftp user setup
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Client facing applications
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Client facing applications" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Client facing applications
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../admin/" class="md-nav__link">
        Admin Suite (satadmin)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../database/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../demo-portal/" class="md-nav__link">
        Demo portal
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Overview
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Overview
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#contents" class="md-nav__link">
    Contents:
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#useful-resources" class="md-nav__link">
    Useful Resources
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        SatSense Client-Facing Applications Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../portal/" class="md-nav__link">
        Portal/SatShop (satportal)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../satdes/" class="md-nav__link">
        Satdes (Data Extraction Service)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../satdom-scripts/" class="md-nav__link">
        Satdom Scripts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../satpgi/" class="md-nav__link">
        Postgres Ingester (satpgi)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tileserver-qgis-fiddle/" class="md-nav__link">
        Integrating Tileservers into QGIS (fiddle)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tileservers/" class="md-nav__link">
        Tileservers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../webmisc/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../what-mike-does/" class="md-nav__link">
        "What Mike does"
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_15" type="checkbox" id="__nav_7_15" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_15">
          Portal
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Portal" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_15">
          <span class="md-nav__icon md-icon"></span>
          Portal
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../portal/portal-overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#contents" class="md-nav__link">
    Contents:
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#useful-resources" class="md-nav__link">
    Useful Resources
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="overview">Overview</h1>
<h3 id="contents">Contents:</h3>
<ul>
<li><a href="#installation-and-configuration">Installation and Configuration</a><ul>
<li><a href="#install-tomcat">Install Tomcat</a></li>
<li><a href="#install-geoserver">Install GeoServer</a></li>
<li><a href="#enable-proxy-from-apache-httpd">Enable Reverse Proxy</a></li>
<li><a href="#geoserver-configuration">GeoServer Configuration</a></li>
</ul>
</li>
<li><a href="#using-geoserver">Using Geoserver</a></li>
</ul>
<h3 id="useful-resources">Useful Resources</h3>
<ul>
<li><a href="https://docs.geoserver.org/latest/en/user/">Official User Manual</a></li>
<li><a href="https://geoserver.geo-solutions.it/edu/en/">Geo-Solutions Training Modules</a></li>
</ul>
<h1 id="installation-and-configuration">Installation and Configuration</h1>
<p>We choose to install GeoServer using the <a href="https://docs.geoserver.org/latest/en/user/installation/war.html">web archive</a> 
via a <a href="https://tomcat.apache.org/">tomcat container</a>.  This seems to be recommended by some users in the community above 
using the <a href="https://docs.geoserver.org/latest/en/user/installation/linux.html">command line installation</a> which utilises 
an in built <a href="http://www.eclipse.org/jetty/">jetty container</a>.</p>
<p>We first provide instructions for installing tomcat, and then for installing GeoServer itself.  Finally, we add some
notes about configuring GeoServer before it should be used.</p>
<h2 id="install-tomcat">Install Tomcat</h2>
<p>We use <a href="https://linuxize.com/post/how-to-install-tomcat-9-on-centos-7/">this linuxize post</a> for reference, but make some
changes - for instance, we use java 11 and not 8.</p>
<p>First make sure the yum packages are up to date:</p>
<p>```shell script
sudo yum update</p>
<pre><code>
First we make sure that we've installed a Java Development Kit.  One can us the openjdk version:

```shell script
sudo yum install java-11-openjdk-devel
</code></pre>
<p>We add a tomcat user and log in:</p>
<p>```shell script
sudo useradd tomcat
sudo su tomcat</p>
<pre><code>
Get the latest download url from the tomcat [download page](https://tomcat.apache.org/download-90.cgi), by right 
clicking on the core `tar.gz` link and copying it.  Note the linked page is for tomcat 9, there may be later version 
available.  Once you have the url, `wget` the `tar.gz` file and unpack it: 

```shell script
# change the following with your url!
wget https://mirrors.ukfast.co.uk/sites/ftp.apache.org/tomcat/tomcat-9/v9.0.36/bin/apache-tomcat-9.0.36.tar.gz
tar -xf apache-tomcat-9.0.36.tar.gz
</code></pre>
<p>Now create a symbolic link so that it is easy to upgrade versions:</p>
<p>```shell script
ln -s /home/tomcat/apache-tomcat-9.0.36 /home/tomcat/tomcat-latest</p>
<pre><code>
We now want to create a systemd process to run tomcat.  Create the service config file:

```shell script
sudo touch /etc/systemd/system/tomcat.service
</code></pre>
<p>and populate it with:</p>
<pre><code>[Unit]
Description=Tomcat 9 servlet container
After=network.target

[Service]
Type=forking

User=tomcat
Group=tomcat

Environment=&quot;JAVA_HOME=/usr/lib/jvm/jre&quot;
Environment=&quot;JAVA_OPTS=-Djava.security.egd=file:///dev/urandom&quot;

Environment=&quot;CATALINA_BASE=/home/tomcat/tomcat-latest&quot;
Environment=&quot;CATALINA_HOME=/home/tomcat/tomcat-latest&quot;
Environment=&quot;CATALINA_PID=/home/tomcat/tomcat-latest/temp/tomcat.pid&quot;
Environment=&quot;CATALINA_OPTS=-Xms512M -Xmx1024M -server -XX:+UseParallelGC&quot;

ExecStart=/home/tomcat/tomcat-latest/bin/startup.sh
ExecStop=/home/tomcat/tomcat-latest/bin/shutdown.sh

[Install]
WantedBy=multi-user.target
</code></pre>
<p>Reload the daemon and start and enable the service:</p>
<p>```shell script
sudo systemctl daemon-reload
sudo systemctl start tomcat.service
sudo systemctl enable tomcat.service</p>
<pre><code>
##  Install GeoServer
We follow the instructions on the 
[web archive installation page](https://docs.geoserver.org/latest/en/user/installation/war.html).

We already have the JDK installed.  Go to the [GeoServer download page](http://geoserver.org/download/), click on 
`stable` and copy the link for the `Web Archive` package.  Back in the command line, whilst logged in as the `tomcat` 
user, get the package and unzip:

```shell script
wget https://sourceforge.net/projects/geoserver/files/GeoServer/2.17.1/geoserver-2.17.1-war.zip
unzip ~/geoserver-2.17.1-war.zip -d geoserver_2_17
</code></pre>
<p>which will unzip it in a new directory called <code>geoserver_2_17</code>.  To deploy GeoServer, either copy the file 
<code>geoserver.war</code> from the unzipped directory to <code>/home/tomcat/apache-tomcat-9.0.36/webapps</code> or create a symbolic link 
to it:</p>
<p>```shell script
ln -s /home/tomcat/geoserver_2_17/geoserver.war /home/tomcat/apache-tomcat-9.0.36/webapps</p>
<pre><code>
and restart tomcat. 

#### Change Data Directory

To ease installing new versions, it is recommended to change the data directory.  To do this, add the following context
parameter

```xml
&lt;context-param&gt;
    &lt;param-name&gt;GEOSERVER_DATA_DIR&lt;/param-name&gt;
    &lt;param-value&gt;/path/to/geoserver_data&lt;/param-value&gt;
&lt;/context-param&gt;
</code></pre>
<p>to the GeoServer <code>web.xml</code> file.  This <code>geoserver_data</code> directory should be owned by the <code>tomcat</code> user. With the above 
installation instructions the <code>web.xml</code> file is located at:</p>
<p>```shell script
/home/tomcat/apache-tomcat-9.0.36/webapps/geoserver/WEB-INF/web.xml</p>
<pre><code>
Restart tomcat when finished.


## Enable reverse proxy from apache httpd

GeoServer should now be running on port 8080.  However, to access the web administration interface, we need to proxy 
certain web request to this port. This can be done either by adding a new [virtual host](webmisc.md#apache-httpd-set-up) 
or adding the following to an existing virtual host:

</code></pre>
<p><VirtualHost *:80></p>
<p>ServerName data.satsense.com
ServerAlias data.satsense.com</p>
<p>ProxyPass /geoserver http://localhost:8080/geoserver
ProxyPassReverse /geoserver http://localhost:8080/geoserver</p>
<p></VirtualHost></p>
<pre><code>
and restart the httpd server

```shell script
sudo systemctl restart httpd.service
</code></pre>
<p>It's possible that you'll need to set tell SELinux to allow httpd proxies:</p>
<p>```shell script
sudo setsebool -P httpd_can_network_connect 1</p>
<pre><code>
Note that the -P flag means that this settings persists upon restart.

Check that you can access the admin page by navigating to `http://data.satsense.com/geoserver/` or similar for your
domain.


## GeoServer configuration

### Security

If you've followed the above instructions you should be on the web admin page. You can log in with the default details:

</code></pre>
<p>username: admin
password: geoserver</p>
<pre><code>
The home page will warn you about:

1. Read the file security/masterpw.info in the GeoServer data directory and then delete it.
2. The default user/group service should use digest password encoding. 
3. The administrator password for this server has not been changed from the default.

It should be clear what to do for the last point.  For the second point, you can edit the default user/group service by 
clicking on `User, Groups, Roles` under `Security`, and then clicking `default`.

For the first point, navigate to the file `security/masterpw.info` in the [data directory](#change-data-directory) and
read its contents. It provides a master password, and should test that you can log in with that password and the 
username `root`.  You may need to enable root sign in by editing 

</code></pre>
<p>security/masterpw/default/config.xml</p>
<pre><code>
in the data directory.  Change the value in the `loginEnabled` tag to `true`, and then restart tomcat.  Remember to
change the `loginEnabled` back and to delete the `masterpw.info` file after you've checked the password works.


### Add domain to GeoServer csrf whitelist

As a layer of protection, GeoServer uses 
[csrf protection](https://docs.geoserver.org/latest/en/user/security/webadmin/csrf.html) and this can be problematic
behind a proxy.  Add the following:

```xml
&lt;context-param&gt;
  &lt;param-name&gt;GEOSERVER_CSRF_WHITELIST&lt;/param-name&gt;
  &lt;param-value&gt;satsense.com&lt;/param-value&gt;
&lt;/context-param&gt;

</code></pre>
<p>to the GeoServer <code>web.xml</code> file.  And then restart tomcat.</p>
<h3 id="change-proxy-base-url">Change Proxy Base Url</h3>
<p>Once you've added a layer, you may find that layer preview urls are incorrect the urls may be generated with 
<code>localhost:8080</code> in them.  Clearly this isn't going to work, unless you are running GeoServer locally.</p>
<p>To fix this, click on <code>Global</code> under the <code>Settings</code> section and set the Proxy Base URL to</p>
<pre><code>http://data.satsense.com/geoserver/
</code></pre>
<h1 id="using-geoserver">Using GeoServer</h1>
<h2 id="add-a-geotiff-layer">Add a geotiff layer</h2>
<h3 id="preparing-a-geotiff">Preparing a geotiff</h3>
<p>We've found that compressing with predictor 2 (i.e. with <code>gdal_translate -co "PREDICTOR=2"</code>) can be problematic.  See
this <a href="https://sourceforge.net/p/geoserver/mailman/message/35858464/">thread</a>. </p>
<p>Unfortunately, some of our code (at time of writing) outputs geotiffs with predictor 2, so you may need to change the 
predictor before inserting into GeoServer.  This can be done via <code>gdal_translate</code>:</p>
<p>```shell script
gdal_translate -co "TILED=YES" -co "BLOCKXSIZE=512" -co "BLOCKYSIZE=512"  -co "COMPRESS=LZW" -co "BIGTIFF=YES" -co "PREDICTOR=1" <input file> <output file></p>
<pre><code>
Notice that the geotiff is also tiled - this is recommended, otherwise the geotiff is blocked in strips and small reads
can be very expensive.  

We also need to add overviews to the geotiff.  The current tileserver uses different geotiffs for its overviews.  
GeoServer can handle internal overviews which are generated via:

```shell script
gdaladdo -r average --config COMPRESS_OVERVIEW LZW &lt;geotiff needing overviews&gt; 2 4 8 16
</code></pre>
<p>The geotiff can then be put into a directory onto the server, which GeoServer can then access. The directory should be
owned by the <code>tomcat</code> user.  The live server geotiffs are contained in the folder <code>/home/tomcat/geoserver_geotiffs</code> 
which is symbolic linked to <code>/data/geoserver_geotiffs</code>. </p>
<h3 id="add-custom-style">Add custom style</h3>
<p>Click <code>Styles</code> under <code>Data</code> and then <code>Add a new style</code>. Give it a name and a workspace. Leave <code>Format</code> as <code>SLD</code> and add</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;StyledLayerDescriptor xmlns=&quot;http://www.opengis.net/sld&quot; xmlns:ogc=&quot;http://www.opengis.net/ogc&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://www.opengis.net/sld
http://schemas.opengis.net/sld/1.0.0/StyledLayerDescriptor.xsd&quot; version=&quot;1.0.0&quot;&gt;
  &lt;NamedLayer&gt;
    &lt;Name&gt;SatSenseRaster&lt;/Name&gt;
    &lt;UserStyle&gt;
      &lt;Title&gt;SatSense Velocity Raster&lt;/Title&gt;
      &lt;FeatureTypeStyle&gt;
        &lt;Rule&gt;
          &lt;RasterSymbolizer&gt;
            &lt;Opacity&gt;0.85&lt;/Opacity&gt;
            &lt;ColorMap&gt;
              &lt;ColorMapEntry opacity=&quot;0&quot; color=&quot;#d7191c&quot; quantity=&quot;-9999&quot;/&gt;
              &lt;ColorMapEntry opacity=&quot;0.85&quot; label=&quot;-7.0&quot; color=&quot;#d7191c&quot; quantity=&quot;-7.0&quot;/&gt;
              &lt;ColorMapEntry opacity=&quot;0.85&quot; label=&quot;-3.5&quot; color=&quot;#eb8c6d&quot; quantity=&quot;-3.5&quot;/&gt;
              &lt;ColorMapEntry opacity=&quot;0.85&quot; label=&quot;0.0&quot; color=&quot;#fffffe&quot; quantity=&quot;0.0&quot;/&gt;
              &lt;ColorMapEntry opacity=&quot;0.85&quot; label=&quot;3.5&quot; color=&quot;#95c1bd&quot; quantity=&quot;3.5&quot;/&gt;
              &lt;ColorMapEntry opacity=&quot;0.85&quot; label=&quot;7.0&quot; color=&quot;#2b83ba&quot; quantity=&quot;7.0&quot;/&gt;
            &lt;/ColorMap&gt;
          &lt;/RasterSymbolizer&gt;
        &lt;/Rule&gt;
      &lt;/FeatureTypeStyle&gt;
    &lt;/UserStyle&gt;
  &lt;/NamedLayer&gt;
&lt;/StyledLayerDescriptor&gt;
</code></pre>
<p>to the text box at the bottom.</p>
<h3 id="add-the-layer-to-geoserver">Add the layer to GeoServer</h3>
<p>First add a workspace, which should be seen as a container for logically similar layers. Click <code>Workspaces</code> under <code>Data</code> 
and then <code>Add a new workspace</code>. Populate <code>Name</code> and the <code>Namespace URI</code>. Specifying what these mean is a TODO.</p>
<p>Then add a store.  Click <code>Stores</code> under <code>Data</code> and <code>Add a new store</code>.  Click <code>Geotiff</code>.  Choose a workspace, and a name
for your store. Then click <code>Browse</code> and navigate to the geotiff.</p>
<p>Then add a layer.  Click <code>Layers</code> under <code>Data</code> and <code>Add a new layer</code>.  Select the <code>Store</code> you've just added.  Click
<code>Publish</code>. Give it a name and a title.  Click publishing tab, and select the style to be the raster style you created.</p>
<h3 id="protect-end-point">Protect end point</h3>
<p>We can protect end points on a per workspace or per layer basis.  For example, in a workspace, selecting the <code>security</code>
tab, we can select which roles can access the workspace.  Adding ROLE_AUTHENTICATED means any user with a user name and 
password can access wms.</p>
<p>Other options (details is a TODO):
* Remove anonymous authentication;
* Disable WCS/WFS;</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../demo-portal/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Demo portal" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Demo portal
            </div>
          </div>
        </a>
      
      
        
        <a href="../overview/" class="md-footer__link md-footer__link--next" aria-label="Next: SatSense Client-Facing Applications Overview" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              SatSense Client-Facing Applications Overview
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.ecf98df9.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.39f04ddb.min.js"></script>
      
    
  </body>
</html>